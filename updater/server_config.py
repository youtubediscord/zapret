"""
server_config.py
────────────────────────────────────────────────────────────────
Конфигурация серверов для балансировки нагрузки
"""

# ═══════════════════════════════════════════════════════════════
# СПИСОК VPS СЕРВЕРОВ (добавляйте свои)
# ═══════════════════════════════════════════════════════════════

VPS_SERVERS = [
    {
        'id': 'vps1',
        'name': 'VPS Server 1 (Основной)',
        'host': '84.54.30.233',
        'https_port': 1094,
        'http_port': 1093,
        'priority': 1,  # Чем меньше - тем выше приоритет
        'weight': 60,   # Вес для балансировки (60% трафика)
    },
    {
        'id': 'vps2',
        'name': 'VPS Server 2 (Резервный)',
        'host': '185.68.247.42',
        'https_port': 888,
        'http_port': 887,
        'priority': 2,
        'weight': 40,  # 40% трафика
    }
]

# ═══════════════════════════════════════════════════════════════
# НАСТРОЙКИ БАЛАНСИРОВКИ
# ═══════════════════════════════════════════════════════════════

# Максимальное количество ошибок подряд до блокировки сервера
MAX_CONSECUTIVE_FAILURES = 3

# Время блокировки сервера при ошибках (в секундах)
SERVER_BLOCK_DURATION = 3600  # 1 час

# Минимальное время отклика для считаемого "быстрым" (мс)
FAST_RESPONSE_THRESHOLD = 2000  # 2 секунды

# Включить автоматическое переключение на более быстрый сервер
AUTO_SWITCH_TO_FASTER = True

# Таймауты
CONNECT_TIMEOUT = 5   # Секунды на подключение
READ_TIMEOUT = 15     # Секунды на чтение данных

# ═══════════════════════════════════════════════════════════════
# ОБРАТНАЯ СОВМЕСТИМОСТЬ (для старого кода)
# ═══════════════════════════════════════════════════════════════

# Основной сервер (первый из списка)
_primary_server = VPS_SERVERS[0] if VPS_SERVERS else None

if _primary_server:
    VPS_SERVER = _primary_server['host']
    HTTPS_PORT = _primary_server['https_port']
    HTTP_PORT = _primary_server['http_port']
    
    VPS_BASE_URLS = {
        'https': f"https://{VPS_SERVER}:{HTTPS_PORT}",
        'http': f"http://{VPS_SERVER}:{HTTP_PORT}"
    }
else:
    VPS_SERVER = None
    HTTPS_PORT = None
    HTTP_PORT = None
    VPS_BASE_URLS = {}

# ═══════════════════════════════════════════════════════════════
# НАСТРОЙКИ SSL
# ═══════════════════════════════════════════════════════════════

VERIFY_SSL = False

def should_verify_ssl() -> bool:
    """Возвращает настройку проверки SSL"""
    return VERIFY_SSL

# ═══════════════════════════════════════════════════════════════
# GITHUB (резервный источник)
# ═══════════════════════════════════════════════════════════════

GITHUB_REPO = "youtubediscord/zapret"